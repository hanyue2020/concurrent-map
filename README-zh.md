# concurrent map [![Build Status](https://travis-ci.com/orcaman/concurrent-map.svg?branch=master)](https://travis-ci.com/orcaman/concurrent-map)

æ­£å¦‚ [è¿™é‡Œ](http://golang.org/doc/faq#atomic_maps) å’Œ [è¿™é‡Œ](http://blog.golang.org/go-maps-in-action)æ‰€æè¿°çš„, Goè¯­è¨€åŸç”Ÿçš„`map`ç±»å‹å¹¶ä¸æ”¯æŒå¹¶å‘è¯»å†™ã€‚`concurrent-map`æä¾›äº†ä¸€ç§é«˜æ€§èƒ½çš„è§£å†³æ–¹æ¡ˆ:é€šè¿‡å¯¹å†…éƒ¨`map`è¿›è¡Œåˆ†ç‰‡ï¼Œé™ä½é”ç²’åº¦ï¼Œä»è€Œè¾¾åˆ°æœ€å°‘çš„é”ç­‰å¾…æ—¶é—´(é”å†²çª)

åœ¨Go 1.9ä¹‹å‰ï¼Œgoè¯­è¨€æ ‡å‡†åº“ä¸­å¹¶æ²¡æœ‰å®ç°å¹¶å‘`map`ã€‚åœ¨Go 1.9ä¸­ï¼Œå¼•å…¥äº†`sync.Map`ã€‚æ–°çš„`sync.Map`ä¸æ­¤`concurrent-map`æœ‰å‡ ä¸ªå…³é”®åŒºåˆ«ã€‚æ ‡å‡†åº“ä¸­çš„`sync.Map`æ˜¯ä¸“ä¸º`append-only`åœºæ™¯è®¾è®¡çš„ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨æƒ³å°†`Map`ç”¨äºä¸€ä¸ªç±»ä¼¼å†…å­˜æ•°æ®åº“ï¼Œé‚£ä¹ˆä½¿ç”¨æˆ‘ä»¬çš„ç‰ˆæœ¬å¯èƒ½ä¼šå—ç›Šã€‚ä½ å¯ä»¥åœ¨golang repoä¸Šè¯»åˆ°æ›´å¤šï¼Œ[è¿™é‡Œ](https://github.com/golang/go/issues/21035) and [è¿™é‡Œ](https://stackoverflow.com/questions/11063473/map-with-concurrent-access)
***è¯‘æ³¨:`sync.Map`åœ¨è¯»å¤šå†™å°‘æ€§èƒ½æ¯”è¾ƒå¥½ï¼Œå¦åˆ™å¹¶å‘æ€§èƒ½å¾ˆå·®***

## ç”¨æ³•

å¯¼å…¥åŒ…:

```go
import (
	"git@github.com:hanyue2020/concurrent-map.git"
)

```

```bash
go get "git@github.com:hanyue2020/concurrent-map.git"
```

ç°åœ¨åŒ…è¢«å¯¼å…¥åˆ°äº†`cmap`å‘½åç©ºé—´ä¸‹
***è¯‘æ³¨:é€šå¸¸åŒ…çš„é™å®šå‰ç¼€(å‘½åç©ºé—´)æ˜¯å’Œç›®å½•åä¸€è‡´çš„ï¼Œä½†æ˜¯è¿™ä¸ªåŒ…æœ‰ç‚¹å…¸å‹ğŸ˜‚ï¼Œä¸ä¸€è‡´ï¼ï¼ï¼æ‰€ä»¥ç”¨çš„æ—¶å€™æ³¨æ„***

## ç¤ºä¾‹

```go

	// åˆ›å»ºä¸€ä¸ªæ–°çš„ map.
	m := cmap.New()

	// è®¾ç½®å˜é‡mä¸€ä¸ªé”®ä¸ºâ€œfooâ€å€¼ä¸ºâ€œbarâ€é”®å€¼å¯¹
	m.Set("foo", "bar")

	// ä»mä¸­è·å–æŒ‡å®šé”®å€¼.
	if tmp, ok := m.Get("foo"); ok {
		bar := tmp.(string)
	}

	// åˆ é™¤é”®ä¸ºâ€œfooâ€çš„é¡¹
	m.Remove("foo")

```

æ›´å¤šä½¿ç”¨ç¤ºä¾‹è¯·æŸ¥çœ‹`concurrent_map_test.go`.

è¿è¡Œæµ‹è¯•:

```bash
go test "git@github.com:hanyue2020/concurrent-map.git"
```

## è´¡çŒ®è¯´æ˜

æˆ‘ä»¬éå¸¸æ¬¢è¿å¤§å®¶çš„è´¡çŒ®ã€‚å¦‚æ¬²åˆå¹¶è´¡çŒ®ï¼Œè¯·éµå¾ªä»¥ä¸‹æŒ‡å¼•:
- æ–°å»ºä¸€ä¸ªissue,å¹¶ä¸”å™è¿°ä¸ºä»€ä¹ˆè¿™ä¹ˆåš(è§£å†³ä¸€ä¸ªbugï¼Œå¢åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œç­‰ç­‰)
- æ ¹æ®æ ¸å¿ƒå›¢é˜Ÿå¯¹ä¸Šè¿°é—®é¢˜çš„åé¦ˆï¼Œæäº¤ä¸€ä¸ªPRï¼Œæè¿°å˜æ›´å¹¶é“¾æ¥åˆ°è¯¥é—®é¢˜ã€‚
- æ–°ä»£ç å¿…é¡»å…·æœ‰æµ‹è¯•è¦†ç›–ç‡ã€‚
- å¦‚æœä»£ç æ˜¯å…³äºæ€§èƒ½é—®é¢˜çš„ï¼Œåˆ™å¿…é¡»åœ¨æµç¨‹ä¸­åŒ…æ‹¬åŸºå‡†æµ‹è¯•(æ— è®ºæ˜¯åœ¨é—®é¢˜ä¸­è¿˜æ˜¯åœ¨PRä¸­)ã€‚
- ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›`concurrent-map`å°½å¯èƒ½ç®€å•ï¼Œä¸”ä¸åŸç”Ÿçš„`map`æœ‰ç›¸ä¼¼çš„æ“ä½œã€‚å½“ä½ æ–°å»ºissueæ—¶è¯·æ³¨æ„è¿™ä¸€ç‚¹ã€‚

## è®¸å¯è¯
MIT (see [LICENSE](https://git@github.com:hanyue2020/concurrent-map.git/blob/master/LICENSE) file)
